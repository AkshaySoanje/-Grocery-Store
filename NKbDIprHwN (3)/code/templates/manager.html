{% extends 'home.html' %}

{% block content%}
{% with massage = get_flashed_messages() %}
{% if massage %}
    <div class = 'mt-3'>
        <div class = "alert alert-success">
        {{massage}}
        </div>
    </div>
{% endif%}

{% endwith %}
<h2> Welcome Manager {{manager.managername}}</h2>
<form action="{{ url_for('logout') }}" method="post">
    <button type="submit" class="btn btn-secondary">Logout</button>
</form>

<div class = "container mt4">
    <h3> Section Management </h3>
    <hr> 
    <div class="btn-group" role="group" aria-label="Section Actions">

        <!-- Add Section-->
        <h3 class = "mt4">        </h3>
        <form action ="{{url_for('add_sec')}}" method = "POST" class="mr-2">
            <button type = "submit" class = 'btn btn-primary'>Add Section</button>
        </form>
        <!-- edit Section-->
        <h3 class = "mt4">       </h3>
        <form action ="{{url_for('edit_sec')}}" method = "POST" class="mr-2 mx-5">
            <button type = "submit" class = 'btn btn-warning'>Edit Section</button>
        </form>
        <!-- delete Section-->
        <h3 class = "mt4"> </h3>
        <form action ="{{url_for('del_sec')}}" method = "POST" >
            <button type = "submit" class = 'btn btn-danger'>Delete Section</button>
        </form>


</div>
<hr>
<br><br><br><br>
<div class="container mt-4">

    <hr style="border: 10px dotted rgb(24, 53, 11) ; border-bottom: none; width: 20%; background-color: white; margin: auto;">

<h3> Product Management</h3>    
<hr>
    <!--  Product Form -->
    <h4 class="mt-4">Add New Product</h4>


    <form enctype="multipart/form-data" action="{{ url_for('add_product') }}" method="post" >
      
    
        <div class="form-group my-2">
            <label for="product_name">Product Name:</label>
            <input type="text" class="form-control mt-1" id="product_name" name="product_name" required>
        </div>
        <div class="form-group my-2">
            <label for="product_price">Price:</label>
            <input type="number" class="form-control mt-1" id="product_price" name="product_price" required>
        </div>
        <div class="form-group my-2">
            <label for="product_description">Description:</label>
            <textarea class="form-control mt-1" id="product_description" name="product_description" rows="1" placeholder= "(per : (unit or kg) and  Expiry :(Expiry date)"></textarea>
        </div>
        <div class="form-group my-2">
            <label for="product_stock">Stock:</label>
            <input type="number" class="form-control mt-1" id="stock" name="stock" required>
        </div>
        <div class="form-group my-2">
            <label for="product_category">Category:</label>
            <select class="form-control mt-1" id="product_category" name="product_category">
                {% for category in sections %}
                    <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="product_image">Product Image:</label>
            <input type="file" class="form-control-file" id="product_image" name="product_image" accept="image/*" required>
        </div>
        <br>
        <button type="submit" class="btn btn-primary">Add Product</button>
    </form>
<br><br><br>
    <!-- Display Products -->
    <hr style="border: 10px dotted rgb(236, 78, 78) ; border-bottom: none; width: 20%; background-color: white; margin: auto;">
    <h4 class="mt-4">Products</h4>
    <ul class="list-group">
        {% for product in products %}
            <li class="list-group-item">
                <div class = "row-align-centre">
                    <div class="col-md-8"  style="font-family: 'Times New Roman', Times, serif; font-size: 20px;">

                {{ product.name }} - Rs. {{ product.price }} : Current Stock {{product.stock}}
                <img src="{{ url_for('static', filename=product.id ~'.png') }}" alt="{{ product.name }}" style="max-height: 100px; float: right;">
                    </div>
                    <div class="col-md-4">
                        <br>
                <a href="{{ url_for('edit_product', product_id=product.id) }}" class="btn btn-success btn-sm"  >Edit</a>
                <a href="{{ url_for('confirm_delete_product', product_id=product.id) }}" class="btn btn-danger btn-sm " >Delete</a>        
                </div>
            </div>
            </li>
        {% endfor %}
    </ul>
</div>



{% endblock %}